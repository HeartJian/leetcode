1.ç»„ä»¶æŒ‚è½½æ›´æ–°çš„æ—¶å€™ é€šè¿‡enqueuePutListener å»æ³¨å†Œäº‹ä»¶
2.äº‹ä»¶å­˜å‚¨ EventPluginHub.putListener
å¯è§æ‰€æœ‰çš„å›è°ƒå‡½æ•°éƒ½ä»¥äºŒç»´æ•°ç»„çš„å½¢å¼å­˜å‚¨åœ¨listenerBankä¸­ï¼Œæ ¹æ®ç»„ä»¶å¯¹åº”çš„keyæ¥è¿›è¡Œç®¡ç†ã€‚


SimpleEventPluginå°†äº‹ä»¶ç±»å‹åˆ’åˆ†æˆäº†ä¸‰ç±», å¯¹åº”ä¸åŒçš„ä¼˜å…ˆçº§(ä¼˜å…ˆçº§ç”±ä½åˆ°é«˜):

DiscreteEvent ç¦»æ•£äº‹ä»¶. ä¾‹å¦‚blurã€focusã€ clickã€ submitã€ touchStart. è¿™äº›äº‹ä»¶éƒ½æ˜¯ç¦»æ•£è§¦å‘çš„
UserBlockingEvent ç”¨æˆ·é˜»å¡äº‹ä»¶. ä¾‹å¦‚touchMoveã€mouseMoveã€scrollã€dragã€dragOverç­‰ç­‰ã€‚è¿™äº›äº‹ä»¶ä¼š'é˜»å¡'ç”¨æˆ·çš„äº¤äº’ã€‚
ContinuousEvent å¯è¿ç»­äº‹ä»¶ã€‚ä¾‹å¦‚loadã€errorã€loadStartã€abortã€animationEnd. è¿™ä¸ªä¼˜å…ˆçº§æœ€é«˜ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬åº”è¯¥æ˜¯ç«‹å³åŒæ­¥æ‰§è¡Œçš„ï¼Œè¿™å°±æ˜¯Continuousçš„æ„ä¹‰ï¼Œå³å¯è¿ç»­çš„æ‰§è¡Œï¼Œä¸è¢«æ‰“æ–­.
1.æ³¨å†Œæ¯ä¸€ä¸ªå¯¹åº”æ˜¯äº‹ä»¶ï¼Œå¹¶ç”¨ç›¸åº”çš„plugin ç®¡ç†
ä¸€ä¸ªplugin å¯¹è±¡åŒ…å«äº†
// event plugin
{
  eventTypes, // ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†æ‰€æœ‰åˆæˆäº‹ä»¶ç›¸å…³çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å…¶å¯¹åº”çš„åŸç”Ÿäº‹ä»¶å…³ç³»
  extractEvents: // ä¸€ä¸ªå‡½æ•°ï¼Œå½“åŸç”Ÿäº‹ä»¶è§¦å‘æ—¶æ‰§è¡Œè¿™ä¸ªå‡½æ•°
}

export type EventTypes = {[key: string]: DispatchConfig};
export type DispatchConfig = {
  dependencies: Array<TopLevelType>, // ä¾èµ–çš„åŸç”Ÿäº‹ä»¶ï¼Œè¡¨ç¤ºå…³è”è¿™äº›äº‹ä»¶çš„è§¦å‘. â€˜ç®€å•äº‹ä»¶â€™ä¸€èˆ¬åªæœ‰ä¸€ä¸ªï¼Œå¤æ‚äº‹ä»¶å¦‚onChangeä¼šç›‘å¬å¤šä¸ª, å¦‚ä¸‹å›¾ğŸ‘‡
  phasedRegistrationNames?: {    // ä¸¤é˜¶æ®µpropsäº‹ä»¶æ³¨å†Œåç§°, Reactä¼šæ ¹æ®è¿™äº›åç§°åœ¨ç»„ä»¶å®ä¾‹ä¸­æŸ¥æ‰¾å¯¹åº”çš„propsäº‹ä»¶å¤„ç†å™¨
    bubbled: string,             // å†’æ³¡é˜¶æ®µ, å¦‚onClick
    captured: string,            // æ•è·é˜¶æ®µï¼Œå¦‚onClickCapture
  },
  registrationName?: string      // propsäº‹ä»¶æ³¨å†Œåç§°, æ¯”å¦‚onMouseEnterè¿™äº›ä¸æ”¯æŒå†’æ³¡çš„äº‹ä»¶ç±»å‹ï¼Œåªä¼šå®šä¹‰  registrationNameï¼Œä¸ä¼šå®šä¹‰phasedRegistrationNames
  eventPriority: EventPriority,  // äº‹ä»¶çš„ä¼˜å…ˆçº§ï¼Œä¸Šæ–‡å·²ç»ä»‹ç»è¿‡äº†
};



åœ¨ReactDOMå¯åŠ¨æ—¶å°±ä¼šå‘EventPluginHubæ³¨å†Œè¿™äº›æ’ä»¶ï¼šæ¯”å¦‚simpleeventplugin  plugin é‡Œæè¿°äº†eventtype é‡Œé¢æœ‰åŸç”Ÿæ—¶é—´çš„ä¾èµ–å…³ç³»ï¼Œäº‹ä»¶ä¼˜å…ˆçº§ï¼Œä¸¤é˜¶æ®µpropsäº‹ä»¶ç»„æµ‹åç§°ã€‚
åœ¨ç»„ä»¶
åœ¨propsåˆå§‹åŒ–å’Œæ›´æ–°æ—¶ä¼šè¿›è¡Œäº‹ä»¶ç»‘å®šã€‚é¦–å…ˆReactä¼šåˆ¤æ–­å…ƒç´ æ˜¯å¦æ˜¯åª’ä½“ç±»å‹ï¼Œåª’ä½“ç±»å‹çš„äº‹ä»¶æ˜¯æ— æ³•åœ¨Documentç›‘å¬çš„ï¼Œæ‰€ä»¥ä¼šç›´æ¥åœ¨å…ƒç´ ä¸Šè¿›è¡Œç»‘å®šã€‚
é€šè¿‡å¯¹åº”çš„pluginæŠŠäº‹ä»¶ä¾èµ–å–å‡ºæ¥ï¼Œå¯¹æ¯”ReactBrowserEventEmitterç»´æŠ¤çš„'å·²è®¢é˜…äº‹ä»¶è¡¨'ã€‚å¦‚æœè¿™ä¸ªäº‹ä»¶æœªè®¢é˜…ï¼Œåˆ™æ ¹æ®ä¼˜å…ˆçº§çš„ä¸åŒç»‘å®šä¸åŒçš„äº‹ä»¶å¤„ç†å™¨ã€‚

è°ƒç”¨dispatchevent æŠŠå±‚çº§å…³ç³»bookingkeepå­˜èµ·æ¥ï¼Œå¼€æ‰¹é‡æ¸²æŸ“å¼€å…³å¹¶è°ƒç”¨ handleTopLevel handleTopLevel ä¼šä¾æ¬¡æ‰§è¡Œ plugins é‡Œæ‰€æœ‰çš„äº‹ä»¶æ’ä»¶ã€‚æœä¸€ä¸ªæ’ä»¶æ£€æµ‹åˆ°è‡ªå·±éœ€è¦å¤„ç†çš„äº‹ä»¶ç±»å‹æ—¶ï¼Œåˆ™å¤„ç†è¯¥äº‹ä»¶ã€‚
é€šè¿‡åŸç”Ÿäº‹ä»¶ç±»å‹å†³å®šä½¿ç”¨å“ªä¸ªåˆæˆäº‹ä»¶ç±»å‹ï¼ˆåŸç”Ÿ event çš„å°è£…å¯¹è±¡ï¼Œä¾‹å¦‚ SyntheticMouseEvent) ã€‚
å¦‚æœå¯¹è±¡æ± é‡Œæœ‰è¿™ä¸ªç±»å‹çš„å®ä¾‹ï¼Œåˆ™å–å‡ºè¿™ä¸ªå®ä¾‹ï¼Œè¦†ç›–å…¶å±æ€§ï¼Œä½œä¸ºæœ¬æ¬¡æ´¾å‘çš„äº‹ä»¶å¯¹è±¡ï¼ˆäº‹ä»¶å¯¹è±¡å¤ç”¨ï¼‰ï¼Œè‹¥æ²¡æœ‰åˆ™æ–°å»ºä¸€ä¸ªå®ä¾‹ã€‚
ä»ç‚¹å‡»çš„åŸç”Ÿäº‹ä»¶ä¸­æ‰¾åˆ°å¯¹åº” DOM èŠ‚ç‚¹ï¼Œä» DOM èŠ‚ç‚¹ä¸­æ‰¾åˆ°ä¸€ä¸ªæœ€è¿‘çš„Reactç»„ä»¶å®ä¾‹ï¼Œ ä»è€Œæ‰¾åˆ°äº†ä¸€æ¡ç”±è¿™ä¸ªå®ä¾‹çˆ¶èŠ‚ç‚¹ä¸æ–­å‘ä¸Šç»„æˆçš„é“¾ï¼Œ è¿™ä¸ªé“¾å°±æ˜¯æˆ‘ä»¬è¦è§¦å‘åˆæˆäº‹ä»¶çš„é“¾
ä¿å­˜å½“å‰å…ƒç´ åŠå…¶çˆ¶å…ƒç´ ä¸ŠæŒ‚åœ¨çš„æ‰€æœ‰äº‹ä»¶å›è°ƒå‡½æ•°ï¼ŒåŒ…æ‹¬æ•è·äº‹ä»¶(captured)å’Œå†’æ³¡äº‹ä»¶(bubbled)ï¼Œä¿å­˜åˆ°äº‹ä»¶eventçš„ _dispatchListenerså±æ€§ä¸Šï¼Œå¹¶ä¸”å°†å½“å‰å…ƒç´ åŠå…¶çˆ¶å…ƒç´ çš„reactå®ä¾‹ï¼ˆåœ¨ v16.xç‰ˆæœ¬ä¸­ï¼Œè¿™é‡Œçš„å®ä¾‹æ˜¯ä¸€ä¸ª FiberNodeï¼‰ä¿å­˜åˆ°eventçš„ _dispatchInstanceså±æ€§ä¸Š
æ‰¹å¤„ç†ï¼šåˆ°çš„äº‹ä»¶ä¸ŠæŒ‚åœ¨çš„ dispatchListenerså¾ªç¯æ‰§è¡ŒexecuteDispatchï¼Œ event.isPropagationStopped()ä¸º trueæ—¶ï¼Œä¸­æ–­åˆæˆäº‹ä»¶çš„å‘ä¸Šéå†æ‰§è¡Œã€‚ invokeGuardedCallbackImplæœ€ç»ˆä¼šæ‰§è¡Œfunc.apply(context, funcArgs);
åå‘è§¦å‘è¿™æ¡é“¾ï¼Œçˆ¶-> å­ï¼Œæ¨¡æ‹Ÿæ•è·é˜¶æ®µï¼Œè§¦å‘æ‰€æœ‰ props ä¸­å«æœ‰ onClickCapture çš„å®ä¾‹
æ­£å‘è§¦å‘è¿™æ¡é“¾ï¼Œå­-> çˆ¶ï¼Œæ¨¡æ‹Ÿå†’æ³¡é˜¶æ®µï¼Œè§¦å‘æ‰€æœ‰ props ä¸­å«æœ‰ onClick çš„å®ä¾‹